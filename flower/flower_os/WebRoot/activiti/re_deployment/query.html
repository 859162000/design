<form name="queryForm" method="post" ng-submit="query()" class="form-horizontal"  >
<div class="portlet light bordered query-container">
	<div class="portlet-title">
		<div class="caption">
			<i class="fa fa-list"></i> 
			<span class="caption-subject font-dark sbold uppercase bold" >部署列表</span>
			<span class="caption-helper"></span>
		</div>
	</div>
	
	<div class="portlet-body form">
		<div class="form-body" ng-show="!hideQueryParams">
			<div class="form-group">				
				<label class="col-sm-1 control-label" >部署ID</label>
				<div class="col-sm-3">
					<input ng-model="current.params.deploymentId" class="form-control" ng-trim="true">
				</div>
				
				
				<label class="col-sm-1 control-label"  >部署名称</label>
				<div class="col-sm-3">
					<input ng-model="current.params.name" class="form-control" ng-trim="true">
				</div>
				<div class="col-sm-3">
					<button type="submit" class="btn btn-primary"   ng-click="query()">查询</button>
					<button type="button" class="btn btn-primary" ng-click="current.isshow=!current.isshow">部署流程</button>
					<button type="button" class="btn btn-primary" ng-disabled="current.selected.length < 1"
						ng-click="remove(current.selected)">删除</button>
				</div>
			</div>
		</div>

		<!-- 部署列表表格 -->
		<div class="table-responsive">
			<table class="table table-striped table-bordered table-condensed" role="grid" 
				st-table="processes" st-safe-src="current.page.content">
				<thead>
					<tr>
					    <th></th>
						<th>ProcessDefinitionId</th>
		                <th>DeploymentId</th>
		                <th>名称</th>
		                <th>KEY</th>
		                <th>版本号</th>
		                <th>XML</th>
		                <th>图片</th>
		                <th>是否挂起</th>
		                <th>操作</th>
					</tr>
				</thead>
				<tbody>
					<tr ng-repeat="process in current.page.content">
						<td ui-table-select="process" selected-rows="current.selected"></td>
						<td ng-bind="::process.id"></td>
						<td ng-bind="::process.deploymentId"></td>
						<td ng-bind="::process.name"></td>
						<td ng-bind="::process.key"></td>
						<td ng-bind="::process.version"></td>
						<td><a target="_blank" href='{{::app.root}}/acti/workflow/resource/read?processDefinitionId={{::process.id}}&resourceType=xml'>查看XML</a></td>
					    <td><a target="_blank" href='{{::app.root}}/acti/workflow/resource/read?processDefinitionId={{::process.id}}&resourceType=image'>查看图片</a></td>

						<td>{{::process.suspended}} |
						    <div ng-if="process.suspended">
						      <a href="processdefinition/update/active/{{::process.id}}">激活</a>
						    </div>
	                        <div ng-if="!process.suspended">
                               <a href="processdefinition/update/suspend/{{::process.id}}">挂起</a>
                            </div>
	                      
                        </td>
						<td class="text-center">
						  <a href="javascript:;"  ng-click="remove(process.deploymentId)">删除</a>
						  <a href="javascript:;"  ng-click="toModel(process.id)">转换为Model</a>
					<!-- 	   <a href='${ctx }/workflow/process/delete?deploymentId=${process.deploymentId}'>删除</a>
                            <a href='${ctx }/workflow/convert-to-model/${process.id}'>转换为Model</a> -->
						</td>
					</tr>
				</tbody>
			</table>
		</div>
		
		<!-- 显示分页 -->
		<div app-page></div>
	</div>
</div>
</form>
<div>
     <fieldset id="deployFieldset" ng-show="current.isshow">
       <legend>部署新流程</legend>
       <div><b>支持文件格式：</b>zip、bar、bpmn、bpmn20.xml</div>
       <form action="/ems/acti/workflow/deploy" method="post" enctype="multipart/form-data">
           <input type="file" name="file" />
           <input type="submit" value="Submit" />
       </form>
     </fieldset>
</div>